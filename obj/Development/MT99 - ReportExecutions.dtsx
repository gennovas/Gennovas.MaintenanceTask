<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/21/2025 9:37:03 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DESKTOP-06GRA2V"
  DTS:CreatorName="DESKTOP-06GRA2V\Sarit Tunthong"
  DTS:DTSID="{EA374404-8BEF-40F1-A34A-831DD0E99D98}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5397.1"
  DTS:LocaleID="1033"
  DTS:ObjectName="MT99 - ReportExecutions"
  DTS:PackageType="5"
  DTS:VersionBuild="61"
  DTS:VersionGUID="{F80C7065-58EB-473A-A2F5-C82D8AD2C429}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5E2ED6A9-8233-4E32-B9FA-493D67ABE1C5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="AccessToken">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C0C451CB-83FC-4BF5-8125-6E404ED486D2}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="LineMessage">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8C5B9FFB-2B8E-41A3-9D3F-338BB6703C13}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="(DT_WSTR,2) DAY(GETDATE()) + &quot; &quot; +&#xA;(&#xA;MONTH(GETDATE()) == 1 ? &quot;มกราคม&quot; :&#xA;MONTH(GETDATE()) == 2 ? &quot;กุมภาพันธ์&quot; :&#xA;MONTH(GETDATE()) == 3 ? &quot;มีนาคม&quot; :&#xA;MONTH(GETDATE()) == 4 ? &quot;เมษายน&quot; :&#xA;MONTH(GETDATE()) == 5 ? &quot;พฤษภาคม&quot; :&#xA;MONTH(GETDATE()) == 6 ? &quot;มิถุนายน&quot; :&#xA;MONTH(GETDATE()) == 7 ? &quot;กรกฎาคม&quot; :&#xA;MONTH(GETDATE()) == 8 ? &quot;สิงหาคม&quot; :&#xA;MONTH(GETDATE()) == 9 ? &quot;กันยายน&quot; :&#xA;MONTH(GETDATE()) == 10 ? &quot;ตุลาคม&quot; :&#xA;MONTH(GETDATE()) == 11 ? &quot;พฤศจิกายน&quot; :&#xA;&quot;ธันวาคม&quot;&#xA;) + &quot; &quot; +&#xA;(DT_WSTR,4) (YEAR(GETDATE()) + 543) + &quot; &quot; +&#xA;RIGHT(&quot;00&quot; + (DT_WSTR,2) DATEPART(&quot;hh&quot;, GETDATE()),2) + &quot;:&quot; +&#xA;RIGHT(&quot;00&quot; + (DT_WSTR,2) DATEPART(&quot;mi&quot;, GETDATE()),2) + &quot;:&quot; +&#xA;RIGHT(&quot;00&quot; + (DT_WSTR,2) DATEPART(&quot;ss&quot;, GETDATE()),2) + &quot;\n&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SendDateTime">
      <DTS:VariableValue
        DTS:DataType="8">22 สิงหาคม 2568 07:00:46
</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F2392703-3434-4220-A961-B34C8CE1B782}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="UserId">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Execute Process Task - Send Report Message"
      DTS:CreationName="Microsoft.ExecuteProcess"
      DTS:Description="Execute Process Task"
      DTS:DTSID="{1671FA67-5E28-4843-9199-1C1CACEA7EFB}"
      DTS:ExecutableType="Microsoft.ExecuteProcess"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute Process Task - Send Report Message"
      DTS:TaskContact="Execute Process Task;Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="Arguments">"-X POST https://api.line.me/v2/bot/message/push " 
+ "-H \"Content-Type: application/json\" " 
+ "-H \"Authorization: Bearer " + @[User::AccessToken] + "\" " 
+ "-d \"{"
+ "\\\"to\\\":\\\"" + @[User::UserId] + "\\\","
+ "\\\"messages\\\":[{\\\"type\\\":\\\"text\\\",\\\"text\\\":\\\"" 
+  @[User::LineMessage]
+ "\\\"}]}\""</DTS:PropertyExpression>
      <DTS:ObjectData>
        <ExecuteProcessData
          Executable="C:\Windows\System32\curl.exe"
          Arguments="-X POST https://api.line.me/v2/bot/message/push -H &quot;Content-Type: application/json&quot; -H &quot;Authorization: Bearer &quot; -d &quot;{\&quot;to\&quot;:\&quot;\&quot;,\&quot;messages\&quot;:[{\&quot;type\&quot;:\&quot;text\&quot;,\&quot;text\&quot;:\&quot;\&quot;}]}&quot;"
          WindowStyle="Hidden" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task - Get Report Message"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{1946453F-FDC0-4614-8193-1923C1D618A7}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task - Get Report Message"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{2E09C410-0A7D-443D-B4AC-A962A512B225}"
          SQLTask:SqlStatementSource="&#xA;DECLARE @msg VARCHAR(4000) = '';&#xA;SELECT @msg = @msg &#xA;             +   + CASE WHEN ExecutionResult = 0 THEN '\u2705'&#xA;                    ELSE '\u274C'&#xA;               END&#xA;             + ' ' + PackageName &#xA;             + '\n'&#xA;FROM dbo.MaintenancePackageResult;&#xA;&#xA;IF @msg &lt;&gt; ''&#xA;BEGIN&#xA;&#x9;DECLARE @Date NVARCHAR(100);&#xA;&#xA;&#x9;SET @Date = &#xA;    CAST(DAY(GETDATE()) AS NVARCHAR(2)) + ' ' +&#xA;    CASE MONTH(GETDATE())&#xA;        WHEN 1 THEN N'มกราคม'&#xA;        WHEN 2 THEN N'กุมภาพันธ์'&#xA;        WHEN 3 THEN N'มีนาคม'&#xA;        WHEN 4 THEN N'เมษายน'&#xA;        WHEN 5 THEN N'พฤษภาคม'&#xA;        WHEN 6 THEN N'มิถุนายน'&#xA;        WHEN 7 THEN N'กรกฎาคม'&#xA;        WHEN 8 THEN N'สิงหาคม'&#xA;        WHEN 9 THEN N'กันยายน'&#xA;        WHEN 10 THEN N'ตุลาคม'&#xA;        WHEN 11 THEN N'พฤศจิกายน'&#xA;        WHEN 12 THEN N'ธันวาคม'&#xA;    END + ' ' +&#xA;    CAST(YEAR(GETDATE()) + 543 AS NVARCHAR(4)) + ' ' +&#xA;    RIGHT('00' + CAST(DATEPART(HOUR, GETDATE()) AS NVARCHAR(2)),2) + ':' +&#xA;    RIGHT('00' + CAST(DATEPART(MINUTE, GETDATE()) AS NVARCHAR(2)),2) + ':' +&#xA;    RIGHT('00' + CAST(DATEPART(SECOND, GETDATE()) AS NVARCHAR(2)),2);&#xA;&#xA;&#x9;SELECT @Date + '\n\n' + ISNULL(LEFT(@msg, LEN(@msg) - 2), '') AS LineMessage;&#xA;END&#xA;ELSE&#xA;&#x9;SELECT @msg AS LineMessage;"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="LineMessage"
            SQLTask:DtsVariableName="User::LineMessage" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{9FD3C0E6-BD1F-4588-949C-76F4FA97D27D}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::LineMessage] != &quot;&quot;"
      DTS:From="Package\Execute SQL Task - Get Report Message"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Execute Process Task - Send Report Message" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{0B0D4C08-FECF-465E-8F41-09FD642F4C84}"
      DTS:EventID="-77574584"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{F9DE9383-546A-413E-9ADF-54529B96F61E}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="292,41.6"
          Id="Package\Execute Process Task - Send Report Message"
          TopLeft="77.2857143906306,139.941176347924" />
        <NodeLayout
          Size="268,41.6"
          Id="Package\Execute SQL Task - Get Report Message"
          TopLeft="61.5714286428934,68.8235293514381" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="195.571428642893,110.423529351438">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="27.7142857477372,29.5176469964863"
              Start="0,0"
              End="27.7142857477372,22.0176469964863">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10.7588234982432" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10.7588234982432"
                    Point2="0,14.7588234982432"
                    Point3="4,14.7588234982432" />
                  <mssgle:LineSegment
                    End="23.7142857477372,14.7588234982432" />
                  <mssgle:CubicBezierSegment
                    Point1="23.7142857477372,14.7588234982432"
                    Point2="27.7142857477372,14.7588234982432"
                    Point3="27.7142857477372,18.7588234982432" />
                  <mssgle:LineSegment
                    End="27.7142857477372,22.0176469964863" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="5.8571428738686,19.7588234982432,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>